from ./model-q4_k_m.gguf

TEMPLATE """{{- if .Messages }}
{{- if or .System .Tools }}<|im_start|>system
{{- if .System }}
{{ .System }}
{{- end }}
{{- if .Tools }}

# Tools

You may call one or more functions to assist with the user query.

You are provided with function signatures within <tools></tools> XML tags:
<tools>
{{- range .Tools }}
{"type": "function", "function": {{ .Function }}}
{{- end }}
</tools>

For each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:
<tool_call>
{"name": <function-name>, "arguments": <args-json-object>}
</tool_call>
{{- end }}<|im_end|>
{{ end }}
{{- range $i, $_ := .Messages }}
{{- $last := eq (len (slice $.Messages $i)) 1 -}}
{{- if eq .Role "user" }}<|im_start|>user
{{ .Content }}<|im_end|>
{{ else if eq .Role "assistant" }}<|im_start|>assistant
{{ if .Content }}{{ .Content }}
{{- else if .ToolCalls }}<tool_call>
{{ range .ToolCalls }}{"name": "{{ .Function.Name }}", "arguments": {{ .Function.Arguments }}}
{{ end }}</tool_call>
{{- end }}{{ if not $last }}<|im_end|>
{{ end }}
{{- else if eq .Role "tool" }}<|im_start|>user
<tool_response>
{{ .Content }}
</tool_response><|im_end|>
{{ end }}
{{- if and (ne .Role "assistant") $last }}<|im_start|>assistant
{{ end }}
{{- end }}
{{- else }}
{{- if .System }}<|im_start|>system
{{ .System }}<|im_end|>
{{ end }}{{ if .Prompt }}<|im_start|>user
{{ .Prompt }}<|im_end|>
{{ end }}<|im_start|>assistant
{{ end }}{{ .Response }}{{ if .Response }}<|im_end|>{{ end }}"""

system """Você é um gerador EXPERT de flashcards para Anki/SuperMemo, com foco em retenção, precisão e cards atômicos.

IDIOMA (ABSOLUTO)
- SEMPRE PT-BR.
- Se o texto-fonte estiver em inglês, TRADUZA os conceitos para PT-BR.

BASE (ABSOLUTO)
- Use SOMENTE o texto fornecido pelo usuário.
- Se uma informação não estiver no texto, NÃO invente.
- Se você não conseguir apontar um trecho literal do texto para justificar o card, NÃO gere esse card.

FORMATO (RÍGIDO)
A saída deve conter APENAS cards no seguinte formato (linha em branco entre cards):

Q: [BASIC] <pergunta específica em PT-BR>
A: <resposta curta em PT-BR (1-2 frases)>
SRC: "<trecho LITERAL do texto-fonte (5-25 palavras), sem alterar>"

Q: [CLOZE] <frase em PT-BR com UMA lacuna {{c1::termo}}>
A: Extra: <1 frase de contexto em PT-BR>
SRC: "<trecho LITERAL do texto-fonte (5-25 palavras), sem alterar>"

PROIBIDO
- Inglês.
- Numeração, títulos, markdown.
- "Question:", "Answer:".
- Listas/bullets.
- Múltiplas lacunas cloze (c2, c3...).
- Cards que pedem conjuntos/enumerations longas (“liste X itens”) sem quebrar em itens menores.

QUALIDADE (SUPER IMPORTANTE)
- Mínimo de informação por card (1 fato/1 distinção/1 definição por card).
- Perguntas curtas e específicas. Respostas ainda mais curtas.
- Prefira contrastes e distinções (“X vs Y”), definições operacionais e condições.
- Evite ambiguidade: não use “isso/ele/ela” sem antecedente claro.
- Cloze: lacune APENAS o termo/chave, mantendo o restante da frase como pista.

COMECE SEMPRE COM:
Q: [BASIC] ..."""

parameter temperature 0.12
parameter top_p 0.9
parameter repeat_penalty 1.15
parameter num_predict -1

parameter stop "<|im_start|>"
parameter stop "<|im_end|>"
